<html>
    <head>
        <style>
        .inline-block {
            display:inline-block;
        }
        .inline{
            display:inline;
        }
        #searchBoxes {
            display:inline;
        }
        #siteSearchInput {

        }
        #destinatinSearchInput {

        }
        #busSearchInput {

        }

        </style>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="sites.js"></script>
        <script src="siteNames.js"></script>
        <script src="sl.js"></script>
        <title>Avgångar</title>
    </head>
    <body>
        <h2>Ekstubben</h2>
        <p id="ekstubben">Laddar...</p>

        <h2>Norra sköndal</h2>
        <p id="norraSkondal">Laddar...</p>

        <h2>Gullmarsplan</h2>
        <p id="gullmarsplan">Laddar...</p>
        
        <h2>Vattugatan</h2>
        <p id="vattugatan">Laddar...</p>
        <br />
        <p id="latestUpdate">Senast uppdaterad: </p>
        <div id="searchBoxes">

            <div class="inline">
            <p>Station</p>
            <input id="siteSearchInput" type="text" onInput="searchSite()" />
            <ul id="siteSearchResult">
            </ul>
            </div>

            <div class="inline">
                <p>Destination</p>
                <input id="destinationSearchInput" type="text" onInput="searchDestination()" />
                <ul id="destinationSearchResult">
                </ul>
            </div>

            <div class="inline-block">
                <p>Busslinje</p>
                <input id="busSearchInput" type="text" />
            </div>
        </div>

        <script>
            let ekstubben = 4604;
            let norraSkondal = 1810;
            let gullmarsplan = 9189;
            let vattugatan = 1003;

            let updateDepartures = (id, data) => {
                let output = document.getElementById(id);
                output.innerText = "";
                data.forEach(d => {output.innerText+=d.designation + " mot " + d.destination + " - " + d.display + "\n"});

                let latestUpdate = document.getElementById("latestUpdate");
                let now = new Date();
                latestUpdate.innerText = `Senast uppdaterad:  ${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`
            };
            /// https://www.trafiklab.se/api/our-apis/sl/transport/
            getDepartures(norraSkondal, ["801", "814"], ["Älta", "Södra Hedvigslund", "Stockholm C"]).then(result => {
                updateDepartures("norraSkondal", result);
            });
            getDepartures(ekstubben, ["801", "814"], ["Gullmarsplan"]).then(result => {
                updateDepartures("ekstubben", result);
            });
            getDepartures(gullmarsplan, ["801", "814"], ["Älta", "Södra Hedvigslund"]).then(result => {
                updateDepartures("gullmarsplan", result);
            });
            getDepartures(vattugatan, ["812C", "813C", "815C"], ["Tyresö Kyrka", "Nyfors", "Tyresö C"]).then(result => {
                updateDepartures("vattugatan", result);
            });

        </script>
    </body>
</html>
